<?php

class accLayoutDoArquivoDeExportacao
{
    
    private $delimitador;
    
    private $camposCabecalho = array();
    
    private $camposCorpo = array();
    
    private $camposRodape = array();
    
    private $data;
    
    protected $lotes;
    
    public function __construct($data, $delimitador = ';' )
    {
        $this->setData($data);
        $this->setDelimitador($delimitador);
        
        $this->popularCampos();
    }
    
    public function popularCampos()
    {
        
    }
    
    public function getDelimitador()
    {
        return $this->delimitador;
    }

    public function setDelimitador($delimitador)
    {
        $this->delimitador = $delimitador;
    }

    public function addCampoCabecalho($codLote, $campoCabecalho)
    {
        if ( $campoCabecalho instanceof campoDoArquivo )
        {
            $this->camposCabecalho[$codLote][$campoCabecalho->id] = $campoCabecalho;
        }
    }
    
    public function addCampoCorpo($codLote, $linha, $campoCorpo)
    {
        if ( $campoCorpo instanceof campoDoArquivo )
        {
            $this->camposCorpo[$codLote][$linha][$campoCorpo->id] = $campoCorpo;
        }
    }
    
    public function addCampoRodape($codLote, $campoRodape)
    {
        if ( $campoRodape instanceof campoDoArquivo )
        {
            $this->camposRodape[$codLote][$campoRodape->id] = $campoRodape;
        }
    }
    
    public function getCamposCabecalho()
    {
        return $this->camposCabecalho;
    }

    public function getCamposCorpo()
    {
        return $this->camposCorpo;
    }

    public function getCamposRodape()
    {
        return $this->camposRodape;
    }
        
    public function getData()
    {
        return $this->data;
    }

    public function setData($data)
    {
        $this->data = $data;
    }
    
    public function getLotes()
    {
        foreach ( $this->lotes as $lote )
        {
            $this->lotes[$lote['cod']]['cabecalho'] = $this->camposCabecalho[$lote['cod']];
            $this->lotes[$lote['cod']]['corpo'] = $this->camposCorpo[$lote['cod']];
            $this->lotes[$lote['cod']]['rodape'] = $this->camposRodape[$lote['cod']];
        }
        
        return $this->lotes;
    }
    
}

class campoDoArquivo
{
    public $id;
    public $posicao;
    public $tamanho;
    public $conteudo;
    
    public function __construct($id, $posicao, $tamanho, $conteudo)
    {
        $this->id = $id;
        $this->posicao = $posicao;
        $this->tamanho = $tamanho;
        $this->conteudo = $conteudo;
    }
}

?>
