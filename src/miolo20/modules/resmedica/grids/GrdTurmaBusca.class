<?php

class GrdTurmaBusca extends SGrid
{
    public function __construct($filters)
    {
        $module = MIOLO::getCurrentModule();
        
        $columns = array(
            'medturma.turmaid' => new MGridColumn(_M('Código', $module), 'left', true, NULL, false, NULL, true),
            'medturma.codigoturma' => new MGridColumn(_M('Código da turma', $module), 'left', true, NULL, true, NULL, true),
            'medturma.descricao' => new MGridColumn(_M('Nome da turma', $module), 'left', true, NULL, true, NULL, true),
            'descricaonucleo' => new MGridColumn(_M('Núcleo profissional'), 'left', true, NULL, true, NULL, true),
            'descricaoenfase' => new MGridColumn(_M('Ênfase'), 'left', true, NULL, true, NULL, true),
            'medturma.quantidadeperiodo' => new MGridColumn(_M('Período de duração', $module), 'right', true, NULL, true, NULL, true),
            'medturma.datainicio' => new MGridColumn(_M('Data inicial', $module), 'center', true, NULL, true, NULL, true),
            'medturma.datafim' => new MGridColumn(_M('Data final', $module), 'center', true, NULL, true, NULL, true),
            'medturma.vagas' => new MGridColumn(_M('Número de vagas', $module), 'right', true, NULL, true, NULL, true),
            'vagasocupada' => new MGridColumn(_M('Vagas ocupadas', $module), 'right', true, NULL, true, NULL, true),
            );
        
        $primaryKeys = array('turmaId'=>'%medturma.turmaid%');
        $args = array('turmaid'=>'%medturma.turmaid%');
        
        parent::__construct($filters, $columns, __CLASS__, $primaryKeys);

        /*
        $listaAlunos = SAGU::getActionURL($module, 'main:register:listaDeAlunos', $primaryKeys);
        $this->addActionIcon(_M('Lista de alunos', $module), 'lista-alunos-16x16.png', $listaAlunos);*/
        
        $listaAlunos = SAGU::getActionURL($module, 'main:register:envioDeEmail', $primaryKeys);
        $this->addActionIcon(_M('Envio de e-mail', $module), 'button_sendemail.png', $listaAlunos);


        $href = SAGU::getActionURL($module, 'main:document:residentesPorTurma', $args);
        $icon = new MGridActionIcon($this, 'visualizar-16x16.png', $href, _M('Residentes por turma', $module));
        $icon->setTarget('_blank');
        $this->actions[] = $icon;
        
        $this->disableExports();
    }
}