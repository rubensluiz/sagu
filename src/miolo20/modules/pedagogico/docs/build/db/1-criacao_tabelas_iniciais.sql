CREATE TABLE acpComponenteDeAvaliacao (componenteDeAvaliacaoId  SERIAL NOT NULL, modeloDeAvaliacaoId int4 NOT NULL, descricao varchar(255) NOT NULL, detalhes varchar(255) NOT NULL, exigeAvaliacoesParciais bool DEFAULT 'false' NOT NULL, permiteAlteracoes bool DEFAULT 'false' NOT NULL, classeDeComponente char(1) NOT NULL, ordem int4 NOT NULL, PRIMARY KEY (componenteDeAvaliacaoId));
CREATE TABLE acpRecuperacao (recuperacaoId  SERIAL NOT NULL, componenteDeAvaliacaoId int4 NOT NULL, estadoDeMatriculaAprovacaoRecuperacaoId int4, estadoDeMatriculaReprovacaoRecuperacaoId int4, aplicacao char(1) NOT NULL, PRIMARY KEY (recuperacaoId));
CREATE TABLE acpConceitosDeAvaliacao (conceitoDeAvaliacaoId  SERIAL NOT NULL, modeloDeAvaliacaoId int4 NOT NULL, descricao varchar(255) NOT NULL, detalhes varchar(255) NOT NULL, resultado char(1) NOT NULL, aprova bool NOT NULL, PRIMARY KEY (conceitoDeAvaliacaoId));
CREATE TABLE acpControleDeFrequencia (controleDeFrequenciaId int4 NOT NULL, modeloDeAvaliacaoId int4 NOT NULL, estadoDeMatriculaId int4, nodeloDeAvaliacaoId int4 NOT NULL, estadoDeReprovacao int4, permiteJustificativa bool DEFAULT 'false' NOT NULL, permiteRecuperacao bool DEFAULT 'false' NOT NULL, tipoDeLimite char(1) NOT NULL, limiteDeFrequencia int4 NOT NULL, PRIMARY KEY (controleDeFrequenciaId, modeloDeAvaliacaoId));
CREATE TABLE acpRelacionamentoDeComponentes (componenteDeAvaliacaoPai int4 NOT NULL, componenteDeAvaliacaoFilho int4 NOT NULL, PRIMARY KEY (componenteDeAvaliacaoPai, componenteDeAvaliacaoFilho));
CREATE TABLE acpEstadoDeMatricula (estadoDeMatriculaId  SERIAL NOT NULL, descricao varchar(255) NOT NULL, PRIMARY KEY (estadoDeMatriculaId));
CREATE TABLE acpComponenteDeAvaliacaoNota (componenteDeAvaliacaoNotaId  SERIAL NOT NULL, componenteDeAvaliacaoId int4 NOT NULL, peso int4, formaDeCalculo char(1) NOT NULL, valorMinimo int4, valorMaximo int4, valorMinimoAprovacao int4, grauDePrecisao int4 NOT NULL, PRIMARY KEY (componenteDeAvaliacaoNotaId));
CREATE TABLE acpComponenteDeAvaliacaoNotaRecuperacao (componenteDeAvaliacaoNotaRecuperacaoId  SERIAL NOT NULL, componenteDeAvaliacaoNotaId int4, formaDeRecuperacao int4, notaDeDispensa int4, pesoDoComponente int4, pesoDaRecuperacao int4, PRIMARY KEY (componenteDeAvaliacaoNotaRecuperacaoId));
CREATE TABLE acpconjuntoDeConceitos (conjuntoDeConceitosId  SERIAL NOT NULL, conceitoDeAvaliacaoId int4, descricao int4, PRIMARY KEY (conjuntoDeConceitosId));
CREATE TABLE acpComponenteDeAvaliacaoConceito (componenteDeAvaliacaoConceitoId  SERIAL NOT NULL, conjuntoDeConceitosId int4, componenteDeAvaliacaoId int4 NOT NULL, PRIMARY KEY (componenteDeAvaliacaoConceitoId));
CREATE TABLE acpPerfilCursoComponenteCurricular (pcccid  SERIAL NOT NULL, perfilCursoId int4, componenteCurricularId int4, modeloDeAvaliacaoId int4, modeloDeAvaliacao int4 NOT NULL, CONSTRAINT acpPerfilCursoComponenteCurricular_perfilCursoComponenteCurricularId PRIMARY KEY (pcccid));
CREATE TABLE acpPerfilCurso (perfilCursoId  SERIAL NOT NULL, modeloDeAvaliacaoGeral int4, modeloDeAvaliacaoSeriado int4, formaDeOferta char(1) NOT NULL, situacao char(1) NOT NULL, organizacao char(1) NOT NULL, percentualConclusaoIngressante int4, percentualConclusaoConcluinte int4, CONSTRAINT acpPerfilCurso_perfilCursoId PRIMARY KEY (perfilCursoId));
CREATE TABLE acpRegrasMatriculaPerfilCurso (regrasMatriculaPerfilCursoId  SERIAL NOT NULL, perfilCursoId int4, tipoInscricao char(1) NOT NULL, formaDeConfirmacaoInscricao char(1) NOT NULL, prazoDeReativacao int4, unidadeDePrazoDeReativacao char(1) NOT NULL, tipoMatricula char(1) NOT NULL, modalidadeMatricula char(1) NOT NULL, exibicaoHorarios char(1) NOT NULL, formaDeConfirmacaoMatricula char(1) NOT NULL, liberarRequisitosEmCursos bool NOT NULL, liberarPendencias bool NOT NULL, liberarSeriesFuturas bool NOT NULL, liberarOptativas bool NOT NULL, liberarOpcionais bool NOT NULL, liberarOpcoesOutrosCursos bool NOT NULL, liberarOpcoesOutrasUnidades bool NOT NULL, liberarOpcoesOutrosTurnos bool NOT NULL, liberarOpcoesRegimeEspecial bool NOT NULL, liberarEquivalencias bool NOT NULL, checarControleChoqueHorario bool NOT NULL, checarRequisitosComponentes bool NOT NULL, checarLimitesContratacao bool NOT NULL, checarVinculoComTurma bool NOT NULL, checarOpcoesOutrasTurmas bool NOT NULL, carenciaParaPendencias int4 NOT NULL, numeroDePendencias int4 NOT NULL, checarDebitosAVencer bool NOT NULL, checarDebitosVencidos bool NOT NULL, checarNegociacoesAbertas bool NOT NULL, checarMultasBiblioteca bool NOT NULL, checarDevolucoesBiblioteca bool NOT NULL, tipoDeControleRequisitos char(1) NOT NULL, quantidadeMinimaTotal int4 NOT NULL, quantidadeMaximaTotal int4 NOT NULL, quantidadeMinimaOutrosCursos int4 NOT NULL, quantidadeMaximaOutrosCursos int4 NOT NULL, quantidadeMinimaOutrasUnidades int4 NOT NULL, quantidadeMaximaOutrasUnidades int4 NOT NULL, quantidadeMinimaOutrosTurnos int4 NOT NULL, quantidadeMaximaOutrosTurnos int4 NOT NULL, dataInicio date, dataFim date, mensagemPasso1 varchar(255), mensagemPasso2 varchar(255), mensagemPasso3 varchar(255), termoInscricao varchar(255), termoMatricula varchar(255), CONSTRAINT acpRegrasMatriculaPerfilCurso_regrasMatriculaPerfilCursoId PRIMARY KEY (regrasMatriculaPerfilCursoId));
CREATE TABLE acpTipoComponenteCurricular (componenteCurricularId  SERIAL NOT NULL, descricao int4, tipo char(1) NOT NULL, habilitado bool NOT NULL, permiteModeloDeAvaliacao bool NOT NULL, CONSTRAINT acpTipoComponenteCurricular_componenteCurricularId PRIMARY KEY (componenteCurricularId));
CREATE TABLE acpTipoDocumento (perfilCursoTipoDocumentoId  SERIAL NOT NULL, perfilCursoIdId int4, documentTypeId int4, exigido bool NOT NULL, CONSTRAINT acpTipoDocumento_perfilCursoTipoDocumentoId PRIMARY KEY (perfilCursoTipoDocumentoId));
CREATE TABLE acpPerfilCursoCamposAdicionais (perfilCursoCamposAdicionaisId  SERIAL NOT NULL, perfilCursoId int4, nomeCampo int4, detalhes int4, habilitado bool NOT NULL, CONSTRAINT acpPerfilCursoCamposAdicionais_perfilCursoCamposAdicionaisId PRIMARY KEY (perfilCursoCamposAdicionaisId));
CREATE TABLE acpModeloDeAvaliacao (modeloDeAvaliacaoId  SERIAL NOT NULL, estadoDeMatriculaReprovacaoId int4, estadoDeMatriculaAprovacaoId int4, descricao varchar(255) NOT NULL, tipoDeDados char(1) NOT NULL, aplicacao char(1) NOT NULL, ativo bool DEFAULT 'true' NOT NULL, detalhesdoResultadoFinal varchar(255), habilitaControleDeFrequencia bool DEFAULT 'false' NOT NULL, habilitaComponentesDeAvaliacao bool DEFAULT 'false' NOT NULL, habilitarRecuperacoes bool DEFAULT 'false' NOT NULL, PRIMARY KEY (modeloDeAvaliacaoId));
ALTER TABLE acpTipoDocumento ADD CONSTRAINT acpTipoDocumento_tipoDeDocumentoId_pk FOREIGN KEY (documentTypeId) REFERENCES basDocumentType (documentTypeId);
ALTER TABLE acpPerfilCursoComponenteCurricular ADD CONSTRAINT acpPerfilCursoComponenteCurricular_componenteCurricularId_pk FOREIGN KEY (componenteCurricularId) REFERENCES acpTipoComponenteCurricular (componenteCurricularId);
ALTER TABLE acpPerfilCursoComponenteCurricular ADD CONSTRAINT acpPerfilCursoComponenteCurricular_modeloDeAvaliacaoId_pk FOREIGN KEY (modeloDeAvaliacaoId) REFERENCES acpModeloDeAvaliacao (modeloDeAvaliacaoId);
ALTER TABLE acpRecuperacao ADD CONSTRAINT acpRecuperacao_estadoDeMatriculaId_pk2 FOREIGN KEY (estadoDeMatriculaAprovacaoRecuperacaoId) REFERENCES acpEstadoDeMatricula (estadoDeMatriculaId);
ALTER TABLE acpComponenteDeAvaliacaoNotaRecuperacao ADD CONSTRAINT acpComponenteDeAvaliacaoNotaRecuperacao_componenteDeAvaliacaoNotaId_pk FOREIGN KEY (componenteDeAvaliacaoNotaId) REFERENCES acpComponenteDeAvaliacaoNota (componenteDeAvaliacaoNotaId);
ALTER TABLE acpRecuperacao ADD CONSTRAINT acpRecuperacao_estadoDeMatriculaId_pk FOREIGN KEY (estadoDeMatriculaReprovacaoRecuperacaoId) REFERENCES acpEstadoDeMatricula (estadoDeMatriculaId);
ALTER TABLE acpModeloDeAvaliacao ADD CONSTRAINT acpModeloDeAvaliacao_estadoDeMatriculaId_pk2 FOREIGN KEY (estadoDeMatriculaReprovacaoId) REFERENCES acpEstadoDeMatricula (estadoDeMatriculaId);
ALTER TABLE acpModeloDeAvaliacao ADD CONSTRAINT acpModeloDeAvaliacao_estadoDeMatriculaId_pk FOREIGN KEY (estadoDeMatriculaAprovacaoId) REFERENCES acpEstadoDeMatricula (estadoDeMatriculaId);
ALTER TABLE acpconjuntoDeConceitos ADD CONSTRAINT acpconjuntoDeConceitos_conceitoDeAvaliacaoId_pk FOREIGN KEY (conceitoDeAvaliacaoId) REFERENCES acpConceitosDeAvaliacao (conceitoDeAvaliacaoId);
ALTER TABLE acpComponenteDeAvaliacaoConceito ADD CONSTRAINT acpComponenteDeAvaliacaoConceito_conjuntoDeConceitosId_pk FOREIGN KEY (conjuntoDeConceitosId) REFERENCES acpconjuntoDeConceitos (conjuntoDeConceitosId);
ALTER TABLE acpComponenteDeAvaliacaoConceito ADD CONSTRAINT acpComponenteDeAvaliacaoConceito_componenteDeAvaliacaoId_pk FOREIGN KEY (componenteDeAvaliacaoId) REFERENCES acpComponenteDeAvaliacao (componenteDeAvaliacaoId);
ALTER TABLE acpComponenteDeAvaliacaoNota ADD CONSTRAINT acpComponenteDeAvaliacaoNota_componenteDeAvaliacaoId_pk FOREIGN KEY (componenteDeAvaliacaoId) REFERENCES acpComponenteDeAvaliacao (componenteDeAvaliacaoId);
ALTER TABLE acpControleDeFrequencia ADD CONSTRAINT acpControleDeFrequencia_estadoDeMatriculaId_pk FOREIGN KEY (estadoDeMatriculaId) REFERENCES acpEstadoDeMatricula (estadoDeMatriculaId);
ALTER TABLE acpRelacionamentoDeComponentes ADD CONSTRAINT acpRelacionamentoDeComponentes_componenteDeAvaliacaoId_pk2 FOREIGN KEY (componenteDeAvaliacaoPai) REFERENCES acpComponenteDeAvaliacao (componenteDeAvaliacaoId);
ALTER TABLE acpRelacionamentoDeComponentes ADD CONSTRAINT acpRelacionamentoDeComponentes_componenteDeAvaliacaoId_pk FOREIGN KEY (componenteDeAvaliacaoFilho) REFERENCES acpComponenteDeAvaliacao (componenteDeAvaliacaoId);
ALTER TABLE acpControleDeFrequencia ADD CONSTRAINT acpControleDeFrequencia_modeloDeAvaliacaoId_pk FOREIGN KEY (nodeloDeAvaliacaoId) REFERENCES acpModeloDeAvaliacao (modeloDeAvaliacaoId);
ALTER TABLE acpPerfilCursoCamposAdicionais ADD CONSTRAINT acpPerfilCursoCamposAdicionais_perfilCursoId_pk FOREIGN KEY (perfilCursoId) REFERENCES acpPerfilCurso (perfilCursoId);
ALTER TABLE acpTipoDocumento ADD CONSTRAINT acpTipoDocumento_perfilCursoId_pk FOREIGN KEY (perfilCursoIdId) REFERENCES acpPerfilCurso (perfilCursoId);
ALTER TABLE acpPerfilCurso ADD CONSTRAINT acpModeloDeAvaliacao_modeloDeAvaliacaoId_pk FOREIGN KEY (modeloDeAvaliacaoSeriado) REFERENCES acpModeloDeAvaliacao (modeloDeAvaliacaoId);
ALTER TABLE acpRegrasMatriculaPerfilCurso ADD CONSTRAINT acpRegrasMatriculaPerfilCurso_perfilCursoId_pk FOREIGN KEY (perfilCursoId) REFERENCES acpPerfilCurso (perfilCursoId);
ALTER TABLE acpPerfilCursoComponenteCurricular ADD CONSTRAINT acpPerfilCursoComponenteCurricular_perfilCursoId_pk FOREIGN KEY (perfilCursoId) REFERENCES acpPerfilCurso (perfilCursoId);
ALTER TABLE acpRecuperacao ADD CONSTRAINT acpRecuperacao_componenteDeAvaliacaoId_pk FOREIGN KEY (componenteDeAvaliacaoId) REFERENCES acpComponenteDeAvaliacao (componenteDeAvaliacaoId);
ALTER TABLE acpComponenteDeAvaliacao ADD CONSTRAINT acpComponenteDeAvaliacao_modeloDeAvaliacaoId_pk FOREIGN KEY (modeloDeAvaliacaoId) REFERENCES acpModeloDeAvaliacao (modeloDeAvaliacaoId);
ALTER TABLE acpPerfilCurso ADD CONSTRAINT acpPerfilCurso_modeloDeAvaliacaoId_pk FOREIGN KEY (modeloDeAvaliacaoGeral) REFERENCES acpModeloDeAvaliacao (modeloDeAvaliacaoId);
ALTER TABLE acpConceitosDeAvaliacao ADD CONSTRAINT acpConceitosDeAvaliacao_modeloDeAvaliacaoId_pk FOREIGN KEY (modeloDeAvaliacaoId) REFERENCES acpModeloDeAvaliacao (modeloDeAvaliacaoId);
CREATE UNIQUE INDEX acpControleDeFrequencia_controleDeFrequenciaId ON acpControleDeFrequencia (controleDeFrequenciaId);

alter table acpPerfilCurso drop situacao;
alter table acpPerfilCurso add ativo boolean not null default true;
alter table acpPerfilCurso add descricao varchar(255);

alter table acpTipoComponenteCurricular alter descricao type varchar(255);

alter table acpperfilcursocomponentecurricular alter modelodeavaliacao drop not null;