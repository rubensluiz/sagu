<?php
class MList
{
    public  $items;
    private $count;

    function __construct()
    {
        $this->items = array
            (
            );

        $this->count = 0;
    }

    function add($item, $key = NULL)
    {
        if (is_null($key))
        {
            $this->items[$this->count++] = $item;
        }
        else
        {
            $this->items[$key] = $item;
            $this->count++;
        }
    }

    function clear()
    {
        $this->items = array
            (
            );

        $this->count = 0;
    }

    function delete($key)
    {
        if (array_key_exists($key, $this->items))
        {
            unset($this->items[$key]);
            $this->count--;
        }
    }

    function insert($item, $key = 0)
    {
        if (is_numeric($key))
        {
            if ($key < $this->count)
            {
                for ($i = $this->count; $i >= $key; $i--)
                    $this->items[$i] = $this->items[$i - 1];
            }
            else
            {
                $key = $this->count;
            }
        }

        $this->add($item, $key);
    }

    function get($key)
    {
        if (array_key_exists($key, $this->items))
        {
            return $this->items[$key];
        }
    }

    function getItems( )
    {
        return $this->items;
    }

    function setItems( $items )
    {
        $this->items = $items;
    }


    function set($key, $item)
    {
        if (array_key_exists($key, $this->items))
        {
            $this->items[$key] = $item;
        }
    }

    function hasItems()
    {
        return ($this->count > 0);
    }
}

class MStringList extends MList
{
    public $duplicates;

    function __construct($duplicates = true)
    {
        parent::__construct();
        $this->duplicates = $duplicates;
    }

    function add($item, $key = NULL)
    {
        if (in_array($item, $this->items))
            if (!$this->duplicates)
                return;

        parent::add($item, $key);
    }

    function addValue($name, $value)
    {
        $this->add($value, $name);
    }

    function find($value)
    {
        return array_search( $value, $this->items);
    }

    function getText($separator = '=', $delimiter = ',')
    {
        $s = '';

        foreach ($this->items as $name => $value)
        {
            $s .= (($s != '') ? $delimiter : '') . (($value != '') ? "$name{$separator}$value" : $name);
        }

        return $s;
    }

    function getValueText($separator = '=', $delimiter = ',')
    {
        $s = '';

        foreach ($this->items as $value)
        {
            $s .= (($s != '') ? $delimiter : '') . $value;
        }

        return $s;
    }

    function getTextByTemplate($template)
    {
        $s = '';

        foreach ($this->items as $name => $value)
        {
            $s .= str_replace('/:n/', $name, str_replace('/:v/', $value, $template));
        }

        return $s;
    }
}

class MObjectList extends MList
{
}
?>
