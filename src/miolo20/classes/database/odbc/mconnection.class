<?php

class ODBCConnection extends MConnection
{
    function __construct($conf)
    {
        parent::__construct($conf);
    }

    function _connect($dbhost, $LoginDB, $LoginUID, $LoginPWD, $persistent = true)
    {
        if ($persistent)
        {
            $this->id = odbc_pconnect($dbhost,$LoginDB, $LoginUID);
        }
        else
        {
            $this->id = odbc_connect($dbhost,$LoginDB, $LoginUID);
        }
    }

    function _close()
    {
        odbc_close($this->id);
    }

    function _error($resource = null)
    {
        return (($error = odbc_error($this->id)) ? odbc_errormsg($this->id) : false);
    }

    function _execute($sql)
    {
        if ($statement = odbc_prepare($this->id, $sql))
        {
            if ($success = odbc_execute($statement))
            {
                $this->affectedrows = odbc_num_rows($statement);
                odbc_free_result($statement);
            }
            else
            {
                $this->traceback[] = $this->_error($statement);
            }
        }
        else
        {
            $this->traceback[] = $this->_error();
        }

        return $success;
    }

    function _createquery()
    {
        return new ODBCQuery();
    }

    function _chartotimestamp($timestamp)
    {
        return $timestamp;
    }

    function _chartodate($date)
    {
        return $date;
    }

    function _timestamptochar($timestamp)
    {
        return $timestamp;
    }

    function _datetochar($date)
    {
        return $date;
    }
}
?>