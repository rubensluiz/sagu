dojo.declare("Miolo.Box",null,{constructor:function(){this.boxMoving=!1,this.boxToMove=null,this.boxPositions=new Array(2),this.onMouseMoveHandler=miolo.associateObjWithEvent(this,"boxPosition")},showBox:function(o,e){var e=Event.element(o),t=e.id.substring(4),i=miolo.getElementById(t);i.style.display="",e.style.display="none",Event.stopObserving(document,"mousemove",this.onMouseMoveHandler)},closeBox:function(o,e){var t=miolo.getElementById(e),i=miolo.getElementById("min_"+e);if(Event.stopObserving(document,"mousemove",this.onMouseMoveHandler),null==i){var s=miolo.getElementById("m-container-minbar");if(!s)return!1;i=document.createElement("span"),i.id="min_"+e,onMouseClick=miolo.associateObjWithEvent(this,"showBox"),Event.observe(i,"click",onMouseClick);var n,l=document.getElementsByClassName("caption",t);n=l.length>0?l[0].innerHTML:"Box",i.innerHTML=n,i.className="m-box-title-minimized",s.appendChild(i),t.style.display="none",s.style.textAlign="left"}else i.style.display="none"==i.style.display?"":"none",t.style.display="none"},hideBoxContent:function(o){for(var e=miolo.isIE?1:2;e<o.childNodes.length;e++)style=o.childNodes[e].style,"undefined"!=typeof style&&(style.display="none"==style.display?"":"none")},moveBox:function(o,e,t){if("none"==e.style.display)return!1;if(!Event.isLeftClick(o))return this.closeBox(o,e);if(t?Event.observe(document,"mousemove",this.onMouseMoveHandler):Event.stopObserving(document,"mousemove",this.onMouseMoveHandler),this.boxToMove=e,this.boxToMove.style.position="relative",t){var i=this.boxToMove.style.left?parseInt(this.boxToMove.style.left):0,s=this.boxToMove.style.top?parseInt(this.boxToMove.style.top):0;this.boxPositions[0]=Event.pointerX(o)-i,this.boxPositions[1]=Event.pointerY(o)-s}return this.boxMoving=t,t||(this.boxToMove.style.position="absolute",document.cookie=this.boxToMove.id+"_position="+this.boxToMove.style.left+","+this.boxToMove.style.top+","+this.boxToMove.tagName+","+this.boxToMove.className,this.boxToMove.style.position="relative"),!t},boxPosition:function(o){var e=Event.pointerX(o),t=Event.pointerY(o),i=this.boxToMove.style;i.left=e-this.boxPositions[0]+"px",i.top=t-this.boxPositions[1]+"px"},setBoxPositions:function(){for(var o=document.cookie.split(";"),e=0;e<o.length;e++){var t=o[e].indexOf("_position");if(t>0){var i=o[e].substr(1,t-1),s=miolo.getElementById(i),n=o[e].split("=")[1].split(",");null!=s&&s.tagName==n[2]&&s.className==n[3]&&(s.style.position="absolute",s.style.left=n[0],s.style.top=n[1],s.style.position="relative")}}}}),miolo.box=new Miolo.Box;