function Lookup(e){window.open("lookup.php?"+e,"lookup","toolbar=no,width="+screen.width+",height="+screen.height+",scrollbars=yes,top=0,left=0,statusbar=yes,resizeable=yes")}function AutoComplete(e,o,t){autoCompleteId=o,autoCompleteInfo=t,e="autocomplete.php?"+e+"&hint="+escape(o.value),top.frames.util.location=e}function SetResult(e){null!=autoCompleteInfo&&(autoCompleteInfo.value=e)}function Deliver(id,text){var lookup_form=null,lookup_field=null,lookup_text=null;if(url=String(window.location),null!=text){for(var pos;-1!=(pos=text.indexOf("+"));)text=text.substring(0,pos)+" "+text.substring(pos+1);text=unescape(text)}var a=url.split("?");if(2==a.length){var b=a[1].split("&");for(i=0;i<b.length;i++){var c=b[i].split("=");if(2==c.length){var name=c[0],value=c[1];"lookup_form"==name?lookup_form=value:"lookup_field"==name?lookup_field=value:"lookup_text"==name&&(lookup_text=value)}}}null!=lookup_form&&(null!=lookup_field&&eval("window.opener.document."+lookup_form+"."+lookup_field+".value='"+id+"'"),null!=lookup_text&&eval("window.opener.document."+lookup_form+"."+lookup_text+".value='"+text+"'")),close()}function LookupContext(){}function MIOLO_AutoComplete(e,o){var t="index.php?module="+o+"&action=autocomplete&name="+escape(e.name)+"&lmodule="+escape(e.module)+"&item="+escape(e.item)+"&event="+escape(e.event)+"&related="+escape(e.related)+"&form="+escape(e.form.name)+"&field="+escape(e.field)+"&value="+escape(e.form[e.field].value);setUtilLocation(t)}function MIOLO_Lookup(e,o){e.type;""==o&&(o="admin");var t=e.form[e.field],l="index.php?module="+o+"&action=lookup&name="+escape(e.name)+"&lmodule="+escape(e.module)+"&item="+escape(e.item)+"&event="+escape(e.event)+"&related="+escape(e.related)+"&type="+escape(e.type);if(null!=t&&(l=l+"&fvalue="+escape(t.value)),null!=e.filter){var i=e.filter.split(",");if(1==i.length){var t=e.form[i[0]];l=l+"&filter="+escape(t.value)}else for(var a=0;a<i.length;a++){var t=e.form[i[a]];l=l+"&filter"+a+"="+escape(t.value)}}if("window"==escape(e.type)){var n=680,u=.6*screen.height;window.open(l,"lookup","toolbar=no,width="+n+",height="+u+",scrollbars=yes,top=0,left=0,statusbar=yes,resizeable=yes")}"dialog"==escape(e.type)&&MIOLO_Dialog("dlgLookup",l,!1,50,50)}function MIOLO_Deliver(name,key,args){var _window=window.opener?"window.opener":"window.parent",__window=eval(_window),lookup=eval(_window+"."+name),isDialog="dialog"==escape(lookup.type),event=lookup.event;if("filler"==event){related=lookup.related;for(var aRelated=related.split(","),count=MIOLO_Deliver.arguments.length,i=2;count>i;i++){var value=MIOLO_Deliver.arguments[i],field=lookup.form["frm_"+aRelated[i-2]];if(null==field)var field=lookup.form[aRelated[i-2]];null!=field&&(field.value=value,field=lookup.form[field.name+"_sel"],null!=field&&(field.value=value))}isDialog||__window.focus()}else __window._doPostBack(event,MIOLO_Deliver.arguments[key+2],lookup.form),lookup.form.submit();var _frame=isDialog?__window.MIOLO_Iframe_Dialogs.dlgLookup:window;_frame.close()}function MIOLO_ActiveLookup(e,o,t,l,i,a,n,u,r){var p=xGetElementById(u);null!=p&&(a=a+"&fvalue="+escape(p.value)),MIOLO_IPopup(e,o,t,l,i,a,n,u,r)}function MIOLO_ActiveDeliver(o,t,l,i){if("filler"==TrimString(l))for(var a=i.split(","),n=MIOLO_ActiveDeliver.arguments.length,u=4;n>u;u++){var r=MIOLO_ActiveDeliver.arguments[u],p=parent.document,s=p.getElementById(a[u-4]);null!=s&&(s.value=r)}e=parent.document.getElementById(o),MIOLO_IPopup_Close(e)}Miolo.lookup=Class.create(),Miolo.lookup.prototype={initialize:function(){},setContext:function(e,o){this.context=e,this.baseModule=""==o?"admin":o},open:function(){var e=(this.context.type,miolo.getElementById(this.context.field)),o="index.php?module="+this.baseModule+"&action=lookup&name="+escape(this.context.name)+"&lmodule="+escape(this.context.module)+"&item="+escape(this.context.item)+"&event="+escape(this.context.event)+"&related="+escape(this.context.related)+"&wtype="+escape(this.context.wtype);if(null!=e&&(o=o+"&fvalue="+escape(this.context.value)),null!=this.context.filter){var t=this.context.filter.split(",");if(1==t.length){var e=miolo.getElementById(t[0]);o=o+"&filter="+escape(e.value)}else for(var l=0;l<t.length;l++){var e=miolo.getElementById(t[l]);o=o+"&filter"+l+"="+escape(e.value)}}if("popup"==escape(this.context.wType)){var i=760,a=.6*screen.height;window.open(o,"lookup","toolbar=no,width="+i+",height="+a+",scrollbars=yes,top=0,left=0,statusbar=yes,resizeable=yes")}"dialog"==escape(this.context.wType)&&miolo.Dialog("dlgLookup",o,!1,50,50,"")},deliver:function(name,key,args){var _window=window.opener?"window.opener":"window.parent",__window=eval(_window),lookup=eval(_window+"."+name),context=lookup.context,arguments=this.deliver.arguments,isDialog="dialog"==escape(context.type),event=context.event;if("filler"==event){related=context.related;for(var aRelated=related.split(","),count=arguments.length,i=2;count>i;i++){var value=arguments[i],field=context.form["frm_"+aRelated[i-2]];if(null==field)var field=context.form[aRelated[i-2]];null!=field&&(field.value=value,field=context.form[field.name+"_sel"],null!=field&&(field.value=value))}isDialog||__window.focus()}else __window.miolo.doPostBack(event,arguments[key+2],context.form),context.form.submit();var _frame=isDialog?__window.miolo.iFrame.dialogs.dlgLookup:window;_frame.close()}};var autoCompleteId,autoCompleteInfo;