function cpaint(){function t(){var t=new cpaint_call(0,e,this.version);return t.test_ajax_capability()}this.version="2.1.0";var e=new Array;e.debugging=-1,e.proxy_url="",e.transfer_mode="GET",e.async=!0,e.response_type="OBJECT",e.persistent_connection=!1,e.use_cpaint_api=!0,e.auth_user=null,e.auth_pass=null;var n=0;this.capable=t(),this.set_debug=function(){"boolean"==typeof arguments[0]?e.debugging=arguments[0]===!0?1:0:"number"==typeof arguments[0]&&(e.debugging=Math.round(arguments[0]))},this.set_proxy_url=function(){"string"==typeof arguments[0]&&(e.proxy_url=arguments[0])},this.set_transfer_mode=function(){("GET"==arguments[0].toUpperCase()||"POST"==arguments[0].toUpperCase())&&(e.transfer_mode=arguments[0].toUpperCase())},this.set_async=function(){"boolean"==typeof arguments[0]&&(e.async=arguments[0])},this.set_response_type=function(){("TEXT"==arguments[0].toUpperCase()||"XML"==arguments[0].toUpperCase()||"OBJECT"==arguments[0].toUpperCase()||"E4X"==arguments[0].toUpperCase()||"JSON"==arguments[0].toUpperCase())&&(e.response_type=arguments[0].toUpperCase())},this.set_persistent_connection=function(){"boolean"==typeof arguments[0]&&(e.persistent_connection=arguments[0])},this.set_use_cpaint_api=function(){"boolean"==typeof arguments[0]&&(e.use_cpaint_api=arguments[0])},this.set_auth_user=function(){"string"==typeof arguments[0]&&(e.auth_user=arguments[0])},this.set_auth_pass=function(){"string"==typeof arguments[0]&&(e.auth_pass=arguments[0])},this.call=function(){var t=-1;if(1==e.persistent_connection&&null!=__cpaint_stack[0])switch(__cpaint_stack[0].get_http_state()){case-1:t=0,o("no XMLHttpObject object to re-use for persistence, creating new one later",2);break;case 4:t=0,o("re-using the persistent connection",2);break;default:o("the persistent connection is in use - skipping this request",2)}else 1==e.persistent_connection?(t=0,__cpaint_stack[t]=new cpaint_call(t,e,this.version),o("no cpaint_call object available for re-use, created new one",2)):(t=n,__cpaint_stack[t]=new cpaint_call(t,e,this.version),o("no cpaint_call object created new one",2));-1!=t&&(__cpaint_stack[t].set_client_callback(arguments[2]),""!=e.proxy_url?__cpaint_stack[t].call_proxy(arguments):__cpaint_stack[t].call_direct(arguments),n++,o("stack size: "+__cpaint_stack.length,2))};var o=function(t,n){var o="[CPAINT Debug] ";1>n&&(o="[CPAINT Error] "),e.debugging>=n&&alert(o+t)};this.set_host_object=function(){e.host_object=arguments[0]}}function cpaint_call(){var version=arguments[2],config=new Array;config.debugging=arguments[1].debugging,config.proxy_url=arguments[1].proxy_url,config.transfer_mode=arguments[1].transfer_mode,config.async=arguments[1].async,config.response_type=arguments[1].response_type,config.persistent_connection=arguments[1].persistent_connection,config.use_cpaint_api=arguments[1].use_cpaint_api,config.auth_user=arguments[1].auth_user,config.auth_pass=arguments[1].auth_pass,config.host_object=arguments[1].host_object;var httpobj=!1,client_callback,stack_id=arguments[0];this.set_client_callback=function(){"function"==typeof arguments[0]&&(client_callback=arguments[0])},this.get_http_state=function(){var t=-1;return"object"==typeof httpobj&&(t=httpobj.readyState),t},this.call_direct=function(t){var e=t[0],n=t[1],o="",r=0;if("SELF"==e&&(e=document.location.href),1==config.use_cpaint_api){for(r=3;r<t.length;r++)o+="string"==typeof t[r]&&""!=t[r]&&-1==t[r].search(/^\s+$/g)&&!isNaN(t[r])&&isFinite(t[r])&&"0"!=t[r].toString().indexOf(0)&&"."==t[r].toString().indexOf(1)?"&cpaint_argument[]="+encodeURIComponent(Number(t[r])):"object"==typeof t[r]?"&cpaint_argument[]="+encodeURIComponent(t[r].toJSONString()):"&cpaint_argument[]="+encodeURIComponent(t[r]);o+="&cpaint_response_type="+config.response_type,"GET"==config.transfer_mode?e=-1!=e.indexOf("?")?e+"&cpaint_function="+n+o:e+"?cpaint_function="+n+o:o="cpaint_function="+n+o}else{for(r=3;r<t.length;r++)o+=3==r?encodeURIComponent(t[r]):"&"+encodeURIComponent(t[r]);"GET"==config.transfer_mode&&(e+=o)}if(get_connection_object(),debug('opening connection to "'+e+'"',1),httpobj.open(config.transfer_mode,e,config.async,config.auth_user,config.auth_pass),"POST"==config.transfer_mode)try{httpobj.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(s){debug("POST cannot be completed due to incompatible browser.  Use GET as your request method.",0)}httpobj.setRequestHeader("X-Powered-By","CPAINT v"+version+" :: http://sf.net/projects/cpaint"),httpobj.onreadystatechange=callback,"GET"==config.transfer_mode?httpobj.send(null):(debug("sending query: "+o,1),httpobj.send(o)),1==config.async&&callback()},this.call_proxy=function(t){var e=config.proxy_url,n=t[0],o=t[1],r="",s=0,a="cpaint_argument[]=";for(0==config.use_cpaint_api&&(a=""),s=3;s<t.length;s++)r+=encodeURIComponent(1==config.use_cpaint_api?"string"==typeof t[s]&&""!=t[s]&&-1==t[s].search(/^\s+$/g)&&!isNaN(t[s])&&isFinite(t[s])?a+Number(t[s])+"&":"object"==typeof t[s]?a+t[s].toJSONString()+"&":a+t[s]+"&":a+t[s]+"&");if(1==config.use_cpaint_api&&(r+=encodeURIComponent("&cpaint_function="+o),r+=encodeURIComponent("&cpaint_response_type="+config.response_type)),"GET"==config.transfer_mode?e+="?cpaint_remote_url="+encodeURIComponent(n)+"&cpaint_remote_query="+r+"&cpaint_remote_method="+config.transfer_mode+"&cpaint_response_type="+config.response_type:r="cpaint_remote_url="+encodeURIComponent(n)+"&cpaint_remote_query="+r+"&cpaint_remote_method="+config.transfer_mode+"&cpaint_response_type="+config.response_type,get_connection_object(),debug('opening connection to proxy "'+e+'"',1),httpobj.open(config.transfer_mode,e,config.async,config.auth_user,config.auth_pass),"POST"==config.transfer_mode)try{httpobj.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(i){debug("POST cannot be completed due to incompatible browser.  Use GET as your request method.",0)}httpobj.setRequestHeader("X-Powered-By","CPAINT v"+version),httpobj.onreadystatechange=callback,"GET"==config.transfer_mode?httpobj.send(null):(debug("sending query: "+r,1),httpobj.send(r)),0==config.async&&callback()},this.test_ajax_capability=function(){return get_connection_object()};var get_connection_object=function(){var t=!1,e=!1;if(0==config.persistent_connection?(debug("Using new connection object",1),e=!0):(debug("Using shared connection object.",1),"object"!=typeof httpobj&&(debug("Getting new persistent connection object.",1),e=!0)),1==e){try{httpobj=new XMLHttpRequest}catch(n){try{httpobj=new ActiveXObject("Msxml2.XMLHTTP")}catch(o){try{httpobj=new ActiveXObject("Microsoft.XMLHTTP")}catch(r){httpobj=null}}}httpobj?t=!0:debug("Could not create connection object",0)}return 4!=httpobj.readyState&&httpobj.abort(),t},callback=function(){var response=null;if(4==httpobj.readyState&&200==httpobj.status){switch(debug(httpobj.responseText,1),debug("using response type "+config.response_type,2),config.response_type){case"XML":debug(httpobj.responseXML,2),response=__cpaint_transformer.xml_conversion(httpobj.responseXML);break;case"OBJECT":response=__cpaint_transformer.object_conversion(httpobj.responseXML);break;case"TEXT":response=__cpaint_transformer.text_conversion(httpobj.responseText);var i,r="";(i=response.search('<script type="text/javascript">'))>0&&(r=response.substring(i).replace('<script type="text/javascript">',"").replace("</script>","").replace("<!--","").replace("//-->",""),eval(r));break;case"E4X":response=__cpaint_transformer.e4x_conversion(httpobj.responseText);break;case"JSON":response=__cpaint_transformer.json_conversion(httpobj.responseText);break;default:debug("invalid response type '"+response_type+"'",0)}null!=response&&"function"==typeof client_callback&&(config.host_object?(config.host_object.callback=client_callback,config.host_object.callback(response,httpobj.responseText)):client_callback(response,httpobj.responseText)),remove_from_stack()}else 4==httpobj.readyState&&401==httpobj.status?debug("HTTP authorization required or credentials were invalid",0):4==httpobj.readyState&&200!=httpobj.status&&debug("invalid HTTP response code '"+Number(httpobj.status)+"'",0)},remove_from_stack=function(){"number"==typeof stack_id&&__cpaint_stack[stack_id]&&0==config.persistent_connection&&(__cpaint_stack[stack_id]=null)},debug=function(t,e){var n="[CPAINT Debug] ";config.debugging<1&&(n="[CPAINT Error] "),config.debugging>=e&&alert(n+t)}}function cpaint_transformer(){this.object_conversion=function(e){var n=new cpaint_result_object,o=0,r="";if("object"==typeof e&&null!=e){for(o=0;o<e.childNodes.length;o++)if(1==e.childNodes[o].nodeType){r=e.childNodes[o].nodeName;break}var s=e.getElementsByTagName(r);for(n[r]=new Array,o=0;o<s.length;o++){var a=t(s[o]);for(attrib=0;attrib<s[o].attributes.length;attrib++)a.set_attribute(s[o].attributes[attrib].nodeName,s[o].attributes[attrib].nodeValue);a.id=s[o].getAttribute("id"),n[r].push(a)}}else debug("received invalid XML response",0);return n},this.xml_conversion=function(t){return t},this.text_conversion=function(t){return e(t)},this.e4x_conversion=function(t){return t=t.replace(/^\<\?xml[^>]+\>/,""),new XML(t)},this.json_conversion=function(t){return t.parseJSON()};var t=function(n){var o=new cpaint_result_object,r="",s=0,a=0;if(1==n.hasChildNodes()){var i="";for(s=0;s<n.childNodes.length;s++)if(r=n.childNodes[s].nodeName,r=r.replace(/[^a-zA-Z0-9_]*/g,""),"object"!=typeof o[r]&&(o[r]=new Array),1==n.childNodes[s].nodeType){var c=t(n.childNodes[s]);for(a=0;a<n.childNodes[s].attributes.length;a++)c.set_attribute(n.childNodes[s].attributes[a].nodeName,n.childNodes[s].attributes[a].nodeValue);o[r].push(c)}else 3==n.childNodes[s].nodeType&&(i+=String(n.childNodes[s].data));""!=i&&(o.data+=e(i))}return o},e=function(t){for(var e="",n=0,o=0,r=0;n<t.length;)if("\\"==t.charAt(n)&&"u"==t.charAt(n+1)){for(o=0,j=2;6>j&&(r=parseInt(t.charAt(n+j),16),isFinite(r));j+=1)o=16*o+r;e+=String.fromCharCode(o),n+=6}else e+=t.charAt(n),n++;return""!=e&&-1==e.search(/^\s+$/g)&&!isNaN(e)&&isFinite(e)&&(e=Number(e)),e}}function cpaint_result_object(){this.id=0,this.data="";var t=new Array;this.find_item_by_id=function(){var t=null,e=arguments[0],n=arguments[1],o=0;if(this[e])for(o=0;o<this[e].length;o++)if(this[e][o].get_attribute("id")==n){t=this[e][o];break}return t},this.get_attribute=function(){var e=null,n=arguments[0];return"undefined"!=typeof t[n]&&(e=t[n]),e},this.set_attribute=function(){t[arguments[0]]=arguments[1]}}var __cpaint_stack=new Array,__cpaint_transformer=new cpaint_transformer;!function(){var t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e={array:function(t){var n,o,r,s,a=["["],i=t.length;for(r=0;i>r;r+=1)s=t[r],o=e[typeof s],o&&(s=o(s),"string"==typeof s&&(n&&(a[a.length]=","),a[a.length]=s,n=!0));return a[a.length]="]",a.join("")},"boolean":function(t){return String(t)},"null":function(){return"null"},number:function(t){return isFinite(t)?String(t):"null"},object:function(t){if(t){if(t instanceof Array)return e.array(t);var n,o,r,s,a=["{"];for(r in t)s=t[r],o=e[typeof s],o&&(s=o(s),"string"==typeof s&&(n&&(a[a.length]=","),a.push(e.string(r),":",s),n=!0));return a[a.length]="}",a.join("")}return"null"},string:function(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/([\x00-\x1f\\"])/g,function(e,n){var o=t[n];return o?o:(o=n.charCodeAt(),"\\u00"+Math.floor(o/16).toString(16)+(o%16).toString(16))})),'"'+e+'"'}};Object.prototype.toJSONString=function(){return e.object(this)},Array.prototype.toJSONString=function(){return e.array(this)}}(),String.prototype.parseJSON=function(){try{return/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/.test(this)&&eval("("+this+")")}catch(e){return!1}};