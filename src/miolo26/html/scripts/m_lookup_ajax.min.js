function Deliver(id,text){var lookup_form=null,lookup_field=null,lookup_text=null;if(url=String(window.location),null!=text){for(var pos;-1!=(pos=text.indexOf("+"));)text=text.substring(0,pos)+" "+text.substring(pos+1);text=unescape(text)}var a=url.split("?");if(2==a.length){var b=a[1].split("&");for(i=0;i<b.length;i++){var c=b[i].split("=");if(2==c.length){var name=c[0],value=c[1];"lookup_form"==name?lookup_form=value:"lookup_field"==name?lookup_field=value:"lookup_text"==name&&(lookup_text=value)}}}null!=lookup_form&&(null!=lookup_field&&eval("window.opener.document."+lookup_form+"."+lookup_field+".value='"+id+"'"),null!=lookup_text&&eval("window.opener.document."+lookup_form+"."+lookup_text+".value='"+text+"'")),close()}function LookupContext(){}function sendRequest(e){return updateImageStatus("block"),http.open("get",e),http.onreadystatechange=handleResponse,http.send(null),http.responseText}function handleResponse(){if(4==http.readyState){updateImageStatus("none");var e=http.responseText,t=new Array;e.indexOf(!0)&&(t=e.split("|")),MIOLO_AutoCompleteDeliver_Ajax(document,varForm,"",varRelated,e)}}function MIOLO_AutoComplete_Ajax(e,t){var l="autocomplete.php?module="+t+"&action=autocomplete&name="+escape(e.name)+"&lmodule="+escape(e.module)+"&item="+escape(e.item)+"&event="+escape(e.event)+"&related="+escape(e.related)+"&form="+escape(e.form.name)+"&field="+escape(e.field)+"&value="+escape(e.form[e.field].value),o=e.filter.split(","),a=e.idxFilter.split(",");for(i=0;i<o.length;i++)l+="&"+a[i]+"="+escape(e.form[o[i]].value);varForm=e.form.name,varRelated=e.related,createImageDiv(),sendRequest(l)}function createImageDiv(){for(var e=varRelated.split(","),t=new Array,l=new Array,o=new Array,a=0;a<e.length;a++)try{t[a]=document.getElementById("m_"+e[a]),campos+="m_"+e[a]+", ",t[a].style.position="relative",loadingImageDivId[a]="loading-image_"+a,l[a]=document.createElement("div"),l[a].id=loadingImageDivId[a],l[a].style.backgroundColor="transparent",l[a].style.border="0",l[a].style.display="none",l[a].style.height=loadingImageWidth+"px",l[a].style.width=loadingImageWidth+"px",l[a].style.padding="0",l[a].style.position="absolute",l[a].style.left=loadingImagePosX+"px",l[a].style.top=loadingImagePosY+"px",t[a].appendChild(l[a]),o[a]=document.createElement("img"),o[a].setAttribute("src",loadingImage),o[a].setAttribute("height",loadingImageHeight),o[a].setAttribute("width",loadingImageWidth),o[a].style.border="0",o[a].style.backgroundColor="transparent",o[a].style.margin="0",o[a].style.padding="0",l[a].appendChild(o[a])}catch(n){txt="Erro: Campo "+t[a]+" - "+n.description+"\n\n",txt+="OK para continuar.\n\n"}}function updateImageStatus(e){for(var t=varRelated.split(","),l=new Array,o=0;o<t.length;o++)try{l[o]=document.getElementById(loadingImageDivId[o]),l[o].style.display=e}catch(a){}}function MIOLO_AutoCompleteDeliver_Ajax(e,t,l,o,a){o=o.split(","),"string"==typeof a&&("nothing_found"==a?(alert("Nenhum dado encontrado!"),a=""):a=a.split("|"));for(var n=0;n<o.length;n++){"undefined"==typeof a[n]&&(a[n]="");try{e.getElementsByName(o[n])[0].value=a[n]}catch(i){}}}function MIOLO_Lookup(e,t,l){""==t&&(t="common");var o=e.form[e.field],a="index.php?module="+t+"&action=lookup&name="+escape(e.name)+"&lmodule="+escape(e.module)+"&item="+escape(e.item)+"&event="+escape(e.event)+"&related="+escape(e.related)+"&autopost="+(e.autoPost?"1":"0");if(null!=o&&(a=a+"&fvalue="+escape(o.value)),null!=e.filter){var n=e.filter.split(","),i=e.idxFilter.split(",");if(useIdx=0!=i[0].charAt(0),1!=n.length||useIdx)for(var r=0;r<n.length;r++){var o=e.form[n[r]];idx=useIdx?i[r]:"filter"+r,a+="&"+idx+"="+escape(o.value),a+="&idx["+escape(n[r])+"]="+escape(i[r])}else{var o=e.form[n[0]];o&&(a=a+"&filter="+escape(o.value))}}var d=e.wWidth?e.wWidth:680,u=e.wHeight?e.wHeight:.6*screen.height;"iframe"==e.wType?(win=document.getElementById("lookupIframe"),null==win&&(win=document.createElement("iframe"),win.id="lookupIframe"),pos=MIOLO_getMousePosition(l),win.style.position="absolute",win.style.width=d,win.style.height=u,win.style.top=(e.wTop.length>0?e.wTop:pos[1])+"px",win.style.left=(e.wLeft.length>0?e.wLeft:pos[0])+"px",win.style.display="",document.body.appendChild(win),win.contentWindow.document.open(),win.contentWindow.document.write('<div class="">Loading...</div>'),win.contentWindow.document.close(),win.src=a):window.open(a,window.document.forms[0].name,"toolbar=no,width="+d+",height="+u+",scrollbars=yes,top=0,left=0,statusbar=yes,resizeable=yes")}function MIOLO_Deliver(name,key){var lookup=eval("MIOLO_getWindow( true )."+name),event=lookup.event;if("filler"==event){for(var aRelated=lookup.related.split(","),exists=!1,i=0;i<aRelated.length;i++)aRelated[i]==lookup.field&&(exists=!0);related=exists||!lookup.field?lookup.related:lookup.field+","+lookup.related,aRelated=related.split(",");for(var count=MIOLO_Deliver.arguments.length,i=2;count>i;i++){var value=MIOLO_Deliver.arguments[i],field=lookup.form["frm_"+aRelated[i-2]];if(null==field)var field=lookup.form[aRelated[i-2]];null!=field&&(field.value=value,field=lookup.form[field.name+"_sel"],null!=field&&(field.value=value))}MIOLO_getWindow(!0).focus()}else MIOLO_getWindow(!0)._doPostBack(event,MIOLO_Deliver.arguments[key+2]),lookup.form.submit();MIOLO_getDocument().getElementById("lookupIframe")?MIOLO_getDocument().getElementById("lookupIframe").style.display="none":window.close(),lookup.autoPost&&(MIOLO_getWindow(!0)._doPostBack(event,MIOLO_Deliver.arguments[key+2]),lookup.form.submit())}function MIOLO_ActiveLookup(e,t,l,o,a,n,i,r,d){var u=xGetElementById(r);null!=u&&(n=n+"&fvalue="+escape(u.value)),MIOLO_IPopup(e,t,l,o,a,n,i,r,d)}function MIOLO_ActiveDeliver(t,l,o,a){if("filler"==TrimString(o))for(var n=a.split(","),i=MIOLO_ActiveDeliver.arguments.length,r=4;i>r;r++){var d=MIOLO_ActiveDeliver.arguments[r],u=parent.document,s=u.getElementById(n[r-4]);null!=s&&(s.value=d)}e=parent.document.getElementById(t),MIOLO_IPopup_Close(e)}function MIOLO_AutoCompleteDeliver(e,t,l,o,a){o=o.split(","),"string"==typeof a&&(a=a.split(","));for(var n=0;n<o.length;n++)"undefined"==typeof a[n]&&(a[n]=""),(field=t[o[n]+"_sel"])&&(field.value=a[n]),(field=t[o[n]])?field.value=a[n]:l&&e.addDebugInformation(l.replace("@1",o[n]))}var autoCompleteId,autoCompleteInfo,loadingImage="images/loading.gif",loadingImageDivId=new Array,loadingImageWidth=13,loadingImageHeight=13,loadingImagePosX=4,loadingImagePosY=4,varDoc="",varForm="",varRelated="";